# 西藏装甲车故障诊断系统

## 项目简介

本项目是一个基于深度学习的装甲车发动机故障诊断系统，主要用于西藏地区装甲车的发动机状态监测和故障识别。系统通过分析发动机振动信号，实现对发动机各缸体的故障诊断和健康状态评估。

## 主要功能

### 1. 故障类型检测
- **1缸失火故障**：检测第1缸燃烧异常情况
- **3缸喷油器雾化故障**：识别第3缸喷油器工作异常
- **6缸气门故障**：诊断第6缸气门开闭问题
- **正常状态监测**：监控发动机正常工作状态

### 2. 多缸体监测
系统支持对6缸发动机的全缸体监测：
- 1缸、2缸、3缸、4缸、5缸、6缸独立监测
- 重点关注2缸和5缸的振动特征分析

### 3. 智能算法支持
- **Deep&Cross网络**：深度交叉神经网络进行特征学习
- **BP神经网络**：传统反向传播网络作为对比
- **变分自编码器(VAE)**：异常检测和数据重构
- **自编码器(AutoEncoder)**：无监督异常检测

## 技术架构

### 核心技术栈
- **深度学习框架**：PyTorch
- **信号处理**：
  - 小波变换（Wavelet Transform）
  - 经验模态分解（EMD/EEMD）
  - 时域和频域特征提取
- **机器学习**：scikit-learn
- **数据处理**：pandas, numpy
- **可视化**：matplotlib, seaborn

### 项目结构
```
西藏装甲车/
├── bench_test/                    # 台架测试数据和模型
│   ├── 1缸失火故障/               # 1缸失火故障相关数据
│   ├── 3缸喷油器雾化故障/         # 3缸喷油器故障数据
│   ├── 6缸气门故障/               # 6缸气门故障数据
│   ├── 正常/                      # 正常状态数据
│   ├── model_train.py             # 模型训练脚本
│   └── BP.py                      # BP神经网络实现
├── deep_cross/                    # Deep&Cross网络实现
│   ├── train.py                   # 训练脚本
│   ├── verify.py                  # 验证脚本
│   └── data_process.py            # 数据处理脚本
├── cut_out_model/                 # 分割模型相关
├── deep_cross.py                  # Deep&Cross网络核心实现
├── data_preprocess.py             # 数据预处理主脚本
├── units.py                       # 工具函数库
├── VAE.py                         # 变分自编码器
└── 验证.py                        # 验证脚本
```

## 数据处理流程

### 1. 数据采集
- **振动信号**：采集各缸体的振动数据
- **压力信号**：记录喷油压力变化
- **采样频率**：102.4kHz
- **数据格式**：CSV文件格式

### 2. 特征提取
- **时域特征**：均值、方差、峰值、RMS等统计特征
- **频域特征**：FFT变换、功率谱密度、频谱峰值
- **小波特征**：小波包能量分布、小波系数统计特征
- **Hilbert变换**：包络分析和瞬时频率特征

### 3. 数据预处理
- **归一化**：MinMaxScaler标准化
- **滤波处理**：Savitzky-Golay平滑滤波
- **异常值处理**：3σ准则和IQR方法
- **数据切分**：按照曲轴转角进行精确切分

## 模型说明

### Deep&Cross网络 (DeepCrossNet)
- **架构**：Cross网络 + 深度网络的并行结构
- **Cross层**：3种实现方式（Vector、Matrix、Mix）
- **深度层**：多层感知机+注意力机制
- **优化器**：Adam优化器，学习率0.003
- **损失函数**：交叉熵损失（分类）/ MSE损失（回归）

### BP神经网络
- **结构**：3层全连接网络
- **激活函数**：Tanh激活
- **应用**：故障分类和状态评估

### 自编码器
- **编码器**：数据压缩和特征提取
- **解码器**：数据重构
- **应用**：异常检测和健康状态监测

## 使用方法

### 1. 环境配置
```bash
pip install torch torchvision
pip install pandas numpy matplotlib
pip install scikit-learn
pip install pywt  # 小波变换
pip install scipy  # 信号处理
```

### 2. 数据预处理
```bash
python data_preprocess.py
```

### 3. 模型训练

#### Deep&Cross网络训练
```bash
python deep_cross/train.py
```

#### BP网络训练
```bash
python bench_test/model_train.py
```

### 4. 模型验证
```bash
python deep_cross/verify.py
```

### 5. 故障诊断
```bash
python 验证.py
```

## 模型性能

### 故障识别准确率
- **1缸失火故障**：准确率 > 90%
- **3缸喷油器雾化故障**：准确率 > 88%
- **6缸气门故障**：准确率 > 92%
- **正常状态识别**：准确率 > 95%

### 评估指标
- **准确率(Accuracy)**：整体预测正确率
- **召回率(Recall)**：故障检出率
- **精确率(Precision)**：误报率控制
- **F1分数**：精确率和召回率的调和平均
- **AUC值**：ROC曲线下面积

## 健康状态评估

### 阈值检测
- **T阈值**：基于IQR方法确定异常阈值
- **3σ准则**：统计学异常检测
- **滑动窗口**：实时健康趋势分析

### 可视化展示
- **混淆矩阵**：分类结果可视化
- **健康趋势图**：设备健康状态变化
- **阈值检测图**：异常点标识和报警

## 车辆信息

项目涵盖以下车辆的数据：
- 204号车
- 215号车 
- 224号车
- 226号车
- 227号车
- 275号车

## 文件说明

### 核心模块
- `deep_cross.py`：Deep&Cross网络的完整实现
- `units.py`：信号处理和特征提取工具函数
- `data_preprocess.py`：数据预处理主程序

### 训练脚本
- `bench_test/model_train.py`：分类模型训练
- `deep_cross/train.py`：Deep&Cross网络训练

### 验证脚本
- `deep_cross/verify.py`：模型性能验证
- `验证.py`：综合验证程序

## 注意事项

1. **数据路径**：请根据实际情况修改代码中的数据路径
2. **计算资源**：建议使用GPU加速训练过程
3. **参数调优**：可根据具体数据特点调整网络参数
4. **阈值设定**：T阈值需要根据实际设备状态进行校准

## 技术支持

本项目专门针对西藏地区装甲车的特殊工况进行优化，考虑了高原环境下的设备特性和故障模式。

## 更新日志

- **v1.0**：基础故障诊断功能实现
- **v1.1**：增加Deep&Cross网络支持
- **v1.2**：优化特征提取算法
- **v1.3**：增加健康状态评估功能
